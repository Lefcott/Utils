<html>
    <head>
      <style>
        body {
          background-color: #cbf590;
          overflow: hidden;
        }
        .cell {
          position: absolute;
          background-color: #44b81d;
          border-style: solid;
          border-width: 0.5px;
          text-align: center;
          transition: 0.2s;
          cursor: pointer;
        }
        .cell:hover {
          background-color: #6d9e28;
          text-shadow: 0 0 3px;
        }
        .cellHead {
          background-color: #2ca105;
          border-style: solid;
          border-width: 1.2px;
        }
        .msg {
          position: absolute;
          border-bottom-left-radius: 50px;
          border-top-left-radius: 50px;
          border-style: solid;
          border-width: 1px;
          background-color: #DDD;
          transition: 0.2s;
          left: 100%;
          top: 50%;
          transform: translate(0, -50%);
          width: 50%;
          height: 80%;
          z-index: 2;
        }
        .close {
          position: absolute;
          transform: translate(-100%);
          left: 99%;
          top: 1%;
          width: 80px;
          height: 40px;
          border-style: solid;
          border-width: 1.8px;
          background-color: #F55;
          text-align: center;
          font-size: 30px;
          cursor: pointer;
          transition: 0.2s;
          z-index: 2;
        }
        .close:hover {
          border-width: 0;
          font-size: 32px;
          background-color: #F77;
        }
        .title {
          position: absolute;
          font-size: 21px;
          width: 100%;
          transform: translate(-50%, -50%);
          left: 50%;
          top: 45px;
        }
        .subtitle {
          position: absolute;
          font-size: 16px;
          width: 100%;
          transform: translate(-50%, -50%);
          left: 50%;
          top: 70px;
        }
        .list {
          background-color: #BBB;
          position: absolute;
          left: 0;
          top: 100px;
        }
        .arrow {
          position: absolute;
          transform: translate(-100%, -50%);
          width: 50px;
          height: 50px;
          border-style: 1.5px;
          transition: 0.2s;
        }
        .arrow:hover {
          width: 55px;
          height: 55px;
        }
      </style>
    </head>
    <body onselectstart = 'return false;' oncontextmenu = 'return false;' onresize = 'resize();'>
      <h1 align = 'center'>Reporte de uso de WhatsApp - Edes</h1>
      <div class = 'msg' id = 'msg'>
        <div class = 'close' onclick = 'closeMsg();'>&times;</div>
        <div class = 'title' id = 'title'>T&iacute;tulo</div>
        <div class = 'subtitle' id = 'subtitle'>Subt&iacute;tulo</div>
        <table class = 'list' id = 'list'></table>
      </div>
      <div class = 'arrow' id = 'arrowRight'>&rarr;</div>
      <div class = 'arrow' id = 'arrowLeft'>&larr;</div>
      <script>
        const msg = document.getElementById('msg');
        const title = document.getElementById('title');
        const subtitle = document.getElementById('subtitle');
        const list = document.getElementById('list');
        const arrowRight = document.getElementById('arrowRight');
        const arrowLeft = document.getElementById('arrowLeft');
        const info = {
          'negocio.usuario.saludos.hola': {
            '01/01/2020': ['hola', 'HOLA!', 'hola que tal', 'HOLA!', 'Hola, como estas?'],
            '02/01/2020': ['holp', 'hello', 'hi', 'HELLLO!!'],
          },
          'negocio.usuario.saludos.adios': {
            '03/01/2020': ['chau', 'Chau!', 'chau nos vemos', 'Chau, hasta la proxima'],
            '04/01/2020': ['bye', 'bye bye', 'Goodbye', 'BYE!!'],
            '05/01/2020': ['bye', 'bye bye', 'Goodbye', 'BYE!!'],
            '06/01/2020': ['bye', 'bye bye', 'Goodbye', 'BYE!!'],
            '06/01/2020': ['bye', 'bye bye', 'Goodbye', 'BYE!!']
          }
        };
        let cols = [], rows = Object.keys(info);
        const iniTop = 50;
        const maxCols = 6, maxRows = 10;
        const firstColWidth = 200, firstRowHeight = 45;
        let width = 85, height = 50;
        let currRow = null, currCol = null;
        setCols();
        resize();
        function setCols() {
          cols = {};
          const infoKeys = Object.keys(info);
          for (let k = 0; k < infoKeys.length; k += 1) {
            const dates = Object.keys(info[infoKeys[k]]);
            for (let m = 0; m < dates.length; m += 1) {
              cols[dates[m]] = 1;
            }
          }
          cols = Object.keys(cols);
        }
        function setFirstCol() {
          for (let k = 0; k < rows.length; k += 1) {
            const cell = document.createElement('div');
            cell.setAttribute('class', 'cell cellHead');
            cell.style.left = 0;
            cell.style.top = `${iniTop + firstRowHeight + k * height}px`;
            cell.style.width = `${firstColWidth}px`;
            cell.style.height = `${height}px`;
            cell.innerHTML = rows[k];
            document.body.appendChild(cell);
          }
        }
        function setFirstRow() {
          for (let k = 0; k < cols.length; k += 1) {
            const cell = document.createElement('div');
            cell.setAttribute('class', 'cell cellHead');
            cell.style.left = `${firstColWidth + k * width}`;
            cell.style.top = `${iniTop}px`;
            cell.style.width = `${width}px`;
            cell.style.height = `${firstRowHeight}px`;
            cell.innerHTML = cols[k];
            document.body.appendChild(cell);
          }
        }
        function setTable() {
          for (let k = 0; k < rows.length; k += 1) {
            for (let m = 0; m < cols.length; m += 1) {
              const cell = document.createElement('div');
              cell.setAttribute('class', 'cell');
              cell.setAttribute('onclick', `clickCell(event.target, ${k}, ${m})`);
              cell.style.left = `${firstColWidth + m * width}`;
              cell.style.top = `${iniTop + firstRowHeight + k * height}px`;
              cell.style.width = `${width}px`;
              cell.style.height = `${height}px`;
              cell.innerHTML = info[rows[k]][cols[m]] ? info[rows[k]][cols[m]].length : 0;
              document.body.appendChild(cell);
            }
          }
        }
        function clickCell(cell, row, col) {
          
          if (currRow === row && currCol === col) {
            closeMsg();
          } else {
            msg.style.left = `${innerWidth / 2}px`;
            currRow = row;
            currCol = col;
            title.innerHTML = rows[row];
            subtitle.innerHTML = cols[col];
            setList(row, col);
          }
        }
        function closeMsg() {
          msg.style.left = '100%';
          currRow = null;
          currCol = null;
        }
        function setList(row, col) {
          list.innerHTML = `<tr><th style = 'width: 77.7%'>Consulta</th><th>Ocurrencias</th></tr>`;
          const phrases = info[rows[row]][cols[col]] || [];
          const insertedPhrases = [];
          for (let k = 0; k < phrases.length; k += 1) {
            if (!insertedPhrases.includes(phrases[k])) {
              list.innerHTML += `<tr><td>${phrases[k]}</td><td align = 'center'>${occInArr(phrases, phrases[k])}</td></tr>`;
              insertedPhrases.push(phrases[k]);
            }
          }
        }
        function occInArr(arr, search) {
          let count = 0;
          for (let k = 0; k < arr.length; k += 1) {
            if (arr[k] === search) {
              count += 1;
            }
          }
          return count;
        }
        function resize() {
          width = (innerWidth - firstColWidth) / Math.min(maxCols, cols.length);
          height = (innerHeight - firstRowHeight) / maxRows;
          setFirstCol();
          setFirstRow();
          setTable();
        }
      </script>
    </body>
</html>